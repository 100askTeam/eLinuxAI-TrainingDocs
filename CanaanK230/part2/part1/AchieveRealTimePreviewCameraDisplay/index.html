<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-CanaanK230/part2/part1/AchieveRealTimePreviewCameraDisplay" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">实现摄像头的显示屏实时预览 | 东山Π</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://eai.100ask.net/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://eai.100ask.net/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://eai.100ask.net/CanaanK230/part2/part1/AchieveRealTimePreviewCameraDisplay"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="实现摄像头的显示屏实时预览 | 东山Π"><meta data-rh="true" name="description" content="硬件要求："><meta data-rh="true" property="og:description" content="硬件要求："><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://eai.100ask.net/CanaanK230/part2/part1/AchieveRealTimePreviewCameraDisplay"><link data-rh="true" rel="alternate" href="https://eai.100ask.net/CanaanK230/part2/part1/AchieveRealTimePreviewCameraDisplay" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://eai.100ask.net/en/CanaanK230/part2/part1/AchieveRealTimePreviewCameraDisplay" hreflang="en"><link data-rh="true" rel="alternate" href="https://eai.100ask.net/CanaanK230/part2/part1/AchieveRealTimePreviewCameraDisplay" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.72113bc9.css">
<script src="/assets/js/runtime~main.5a458611.js" defer="defer"></script>
<script src="/assets/js/main.79abe73f.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="DshanPI" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="DshanPI" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">eLinux AI开发</b></a><a class="navbar__item navbar__link" href="/ELinuxAIBase/BoardIntroduction-1">嵌入式AI基础</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/CanaanK230/Userdoc">嘉楠K230开发</a><a class="navbar__item navbar__link" href="/CanaanK510/YOLOV5-ObjectDetectionAlgorithm">嘉楠K510开发</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>简体中文</a><ul class="dropdown__menu"><li><a href="/CanaanK230/part2/part1/AchieveRealTimePreviewCameraDisplay" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-Hans">简体中文</a></li><li><a href="/en/CanaanK230/part2/part1/AchieveRealTimePreviewCameraDisplay" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li></ul></div><a href="https://github.com/100askTeam/eLinuxAI-TrainingDocs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/CanaanK230/Userdoc">文档阅读指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/CanaanK230/download">开发板资料下载</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/category/开发板上手指南">开发板上手指南</a><button aria-label="展开侧边栏分类 &#x27;开发板上手指南&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/category/基础实验">基础实验</a><button aria-label="展开侧边栏分类 &#x27;基础实验&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/category/摄像头实验">摄像头实验</a><button aria-label="展开侧边栏分类 &#x27;摄像头实验&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/category/特征检测">特征检测</a><button aria-label="展开侧边栏分类 &#x27;特征检测&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/category/颜色处理">颜色处理</a><button aria-label="展开侧边栏分类 &#x27;颜色处理&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/category/条形码处理">条形码处理</a><button aria-label="展开侧边栏分类 &#x27;条形码处理&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/category/ai视觉实验">AI视觉实验</a><button aria-label="展开侧边栏分类 &#x27;AI视觉实验&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/category/多媒体应用">多媒体应用</a><button aria-label="展开侧边栏分类 &#x27;多媒体应用&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/category/网络应用">网络应用</a><button aria-label="展开侧边栏分类 &#x27;网络应用&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/category/常见问题">常见问题</a><button aria-label="展开侧边栏分类 &#x27;常见问题&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/category/micropython参考开发指南">MicroPython参考开发指南</a><button aria-label="展开侧边栏分类 &#x27;MicroPython参考开发指南&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/category/进阶-rtsmartlinux双系统开发">进阶-RTSmart+Linux双系统开发</a><button aria-label="折叠侧边栏分类 &#x27;进阶-RTSmart+Linux双系统开发&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/CanaanK230/part2/DshanPICanMVK230SDKEnvironmentConstruction">K230 双系统SDK环境搭建</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/CanaanK230/part2/K230SDKUserGuide">K230_SDK使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/CanaanK230/part2/K230_SDKDevelopmentGuide">K230_SDK开发指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/CanaanK230/part2/frequentlyUsedCommands">常用命令</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/CanaanK230/part2/FileTransferGuidelines">开发板文件传输</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/category/嵌入式应用开发指南">嵌入式应用开发指南</a><button aria-label="折叠侧边栏分类 &#x27;嵌入式应用开发指南&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/CanaanK230/part2/part1/K230PracticalBasics-hello world">hello world 基础应用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/CanaanK230/part2/part1/CameraExperimentCaptureImage">摄像头实验-捕获一张图像</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/CanaanK230/part2/part1/CameraExperimentDifferentResolutions">摄像头实验-捕获不同分辨率图像</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/CanaanK230/part2/part1/DisplayExperimentDisplayImage">显示屏实验-显示一张图像</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/CanaanK230/part2/part1/DisplayExperimentDifferentResolutions">显示屏实验-显示不同分辨率图像</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/CanaanK230/part2/part1/AchieveRealTimePreviewCameraDisplay">实现摄像头的显示屏实时预览</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/CanaanK230/part2/part1/CameraExperimentEncodingVideoStream">摄像头实验-编码视频流</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/CanaanK230/part2/part1/DisplayExperimentDecodingDisplay">显示屏实验-解码显示</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/CanaanK230/part2/part1/K230SDKCanMVBoardDemoDirectionsforuse">CanMV Board Demo使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/CanaanK230/part2/part1/K230AIDemointroduce">K230 AI Demo介绍</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/CanaanK230/part2/part1/K230FancyPOCintroduce">K230 Fancy POC介绍</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/CanaanK230/part2/part1/K230HeteronuclearCommunication">K230 异核通信 Demo使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/CanaanK230/part2/part1/K230GPUPracticalapplication-VGLitedrawscoolgraphics">K230 GPU 应用实战 - VGLite 绘制酷炫图形</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/CanaanK230/part2/part1/K230SceneCombatSmartDoorLockPOC">K230 场景实战-智能门锁POC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/CanaanK230/part2/part1/K230GUIpractical LVGLportingtutorials">K230 GUI实战 - LVGL移植教程</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/CanaanK230/part2/part1/K230SceneCombatSmartDoorLockPOC3DStructuredLight">K230 场景实战-智能门锁POC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/CanaanK230/part2/part1/K230RVVActualcombat">K230 RVV实战</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/CanaanK230/part2/part1/K230SceneCombatMaoyanPOC">K230 场景实战-猫眼POC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/CanaanK230/part2/part1/K230SceneCombatDictionaryPenPOC">K230 场景实战-词典笔POC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/CanaanK230/part2/part1/K230USBapplicationisUVCtransmissionofYUVandcodedstreams">K230 USB应用实战-UVC传输YUV及编码码流</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/CanaanK230/part2/part1/K230codingpracticertspserverbuildandpushstreams">K230 编码实战 - rtsp sever搭建和推流</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/CanaanK230/part2/part1/K230imagepracticebootvideoandbootlogo">K230 图像实战 - 开机视频和开机logo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/CanaanK230/part2/part1/K230SceneCombatdpuDepthCameraPOC">K230 场景实战-dpu深度相机POC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/CanaanK230/part2/part1/K230AIActualcombatHHBNeuralNetworkModelDeploymentTool">K230 AI实战 - HHB神经网络模型部署工具</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/CanaanK230/part2/part1/K230SDKEVBBoardDemoDirectionsforuse">K230 SDK EVB Board Demo使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/CanaanK230/part2/part1/K230audiopracticeaudiocollectionplaybackandencoding">K230 音频实战 - 音频采集、播放和编解码</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/category/系统开发指南">系统开发指南</a><button aria-label="展开侧边栏分类 &#x27;系统开发指南&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/category/sdk-api参考指南">SDK API参考指南</a><button aria-label="展开侧边栏分类 &#x27;SDK API参考指南&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/category/常见问题-1">常见问题</a><button aria-label="展开侧边栏分类 &#x27;常见问题&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/category/进阶-系统级ai应用开发指南">进阶-系统级AI应用开发指南</a><button aria-label="展开侧边栏分类 &#x27;进阶-系统级AI应用开发指南&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/category/进阶-linux单系统开发">进阶-Linux单系统开发</a><button aria-label="展开侧边栏分类 &#x27;进阶-Linux单系统开发&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/category/进阶-rtsmartlinux双系统开发"><span itemprop="name">进阶-RTSmart+Linux双系统开发</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/category/嵌入式应用开发指南"><span itemprop="name">嵌入式应用开发指南</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">实现摄像头的显示屏实时预览</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>实现摄像头的显示屏实时预览</h1>
<p>硬件要求：</p>
<ul>
<li>DshanPI-CanMV开发板</li>
<li>GC2093摄像头</li>
<li>Type-C数据线 x2</li>
<li>MIPI显示屏/HDMI显示屏</li>
</ul>
<p>开发环境：</p>
<ul>
<li>Ubuntu20.04</li>
</ul>
<p>资料具体位置： <code>09_RTSmart+Linux双系统资料\02_多媒体应用示例源码\05_sample_vivo*</code></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1数据流框图">1.数据流框图<a href="#1数据流框图" class="hash-link" aria-label="1.数据流框图的直接链接" title="1.数据流框图的直接链接">​</a></h2>
<p><img loading="lazy" alt="image-20241024154139615" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAnoAAABWCAIAAADXOaw/AAAOu0lEQVR4nO3dT0zbZh8HcIe3O5bNcTXprTapiuFQbVOy4mxoKpWCVOwCB6axOu2qigoES0770wIFoWlSVxpaqVKlJoBSNYetTShoHGgahjSkElUa9aZE2rRDsYWmnSZMKnac3vEens1yHfIHiBNDvp9DRWzHfRx+eX74eR4/j21zc5MCAAAAM9VUugAAAAD7H9ItAACA6ZBuAQAATId0CwAAYDqkWwAAANMh3QIAAJjugOH1S/VchUpiaX89kypdhIpBSGypakMC8ZALQgL0suMBd7cAAACmM97dElX7Z1o2/OFGICQ0CAnEgwFCAiGhlysecHcLAABgOqRbAAAA0yHdAgAAmA7pFgAAwHRItwAAAKZDugUAADAd0i0AAIDpkG4BAABMh3QLAABgOqRbAAAA0yHdAgAAmA7pFgAAwHRItwAAAKZDugUAADAd0i0AAIDpkG4BwFrcbrff78+1Nx6P22y2dDqtbVFVdWJiQhAE278EQYhGo+UqL0BRkG4BwFp6enpCoZCqqlvunZubY1nW6XSSl+l0+t13371+/Xpzc/PSvxoaGvx+v9vtznUSgPI7UOkCAAC84OTJkxRFLSwseL3e7L3RaHR0dJT8rKqqx+NhWTaRSDAMox1z/Pjxzz77TBAEQRCePn1axrID5IS7WwCwFofDIYri7Oxs9q54PJ7JZEg+pihqZGTEbrcbci3BMEwsFpMkaWJioiylBigA6RYALKejoyMWi2U3Bc/NzfE873A4yMtoNHrp0qXsXEs4HA6fzxcOh80vL0BhSLcAYDlae7J+o6qqoVCoq6uLvEwmk5lMprGxMc952tvbJUlCDy5YAdItAFgOwzA+ny8Sieg3kuyrtSQT2pipLdXW1lIU9euvv5pWUoBiId0CgBW1t7fPz88riqJtmZ2dFUUxV9MxgMUh3QKAFbW2ttI0rbUnq6oai8XOnz9f6XIB7BDSLQBYlH6g08LCAk3Tra2t2t6DBw+SHtw8Z9jY2CDPBZlfWIACkG4BwKJOnz4tSRJpT45EIobHcJ1OJ03Tjx49ynOGubk5juPMLylAYUi3AGBRTqeTZdmFhQVFUebn58+ePWs4YHBwMM/8U4qihEKhzz//vCyFBSigNOk2nU57vV4yW6ndbvf7/foBDlBVyJS2eQLA7XZrtymCIIyNjRU8ZzQa1WbEJQGmnzI3mUzabLYSFR+spbe3NxwOLywssCyb3Sbc3d1tt9sFQcjOuKqqiqLI8/yWU1PBnkDmBct/TDGVg15dXZ3X663IlNolSLeKong8HoqiHj58uLS09PXXXyuKwnEcMm51IiNc7ty5s+VeRVEkSero6Cj+hH6//8yZMw0NDWQ6XBJgHo8nf6cd7A+dnZ2SJIXDYVEUs/cyDDMzM5PJZOrr64eHh5P/Gh4erq+vZxjmm2++qUSpoUyKrBzGx8e1+bRv3bpFsnIFptTefNGBuoYDdQ2b2+Hz+ViWNWxkWfb+/fvbOo817eAD2WdKFRLE+Pg4TdPaS57nA4FAnlMFAgGaplOplGG7KIo0Ta+trW1ubi4tLWVHsnmqPCTKf/mk81WW5VwHrK2tjY+P8zyvVWuiKJaz/kFImHT5PM/zPJ9rb/GVw9LSkuEYWZY5juM4jhxWWrk+kNLc3dbV1Rk2rqysoA1nb7lw4YJhVoEd6+vrk2VZ36SjCYfDxQeGqqoDAwODg4PZUxlcvXrVbrf//vvvpSgvbK2EIbEbT58+3dzc1CZuzMYwTF9fXyKR0Oq1aDSK+scMFgmJ3VcODocjkUjIspyrHc4MJUi3r7zySsFjFEXx+/12u500nRu668jilMlk0u12a8tV6itrRVH0fcPDw8P6RoB0Oq2d3Gazeb1eQ0vC2NgYOSE5fzGdhVUolUpduHDh7bff3v3XiYxwmZqaMmwnLcnZA15yIc9cdnd3Z+9yOBwrKyuGb9rY2BgJA7vdvt0Yg2wlDAnYH6wTEtutHLKRmcsmJydNK6NRCdJtR0fH/Px8np5n0pVLUZQkSZubm5FI5MGDB4blo2dnZz/99NObN2+S23yyrpaWU0VRtNvt5K5fkqTvvvtO+5MknU57PB6apsnJ19bWjh071tTUlF2enp4ecv7+/v7dX/V+VaqvkyiKsVjMsPHOnTtbDnjJ5fHjxzzPFzmLEImoZ8+ebW5uBoPBgYEBQ8bNH2OQi3VqWLAIK4TEtiqHXE6dOiXLcvmGGRXZ6Jyfz+ejKIrjuPHx8ewuFp/PZ2h/T6VS5HdGXpJOF/0bZVmmKErrfdmy8Z1gWXZoaMiwkbTpa43ygUBAf7ZtOVDXUGM/XKZfhsW4XK67d+/uLCTIb9DwW8v+ZeXvu83fc6Mh3TM+n0+/0dB/XDDGilflIVHz6pFq7qfcEkKi/H2326occqWP/Ht3zMS+W4qigsFgKpVyu92XL19mWdbr9eqb6UKh0Pvvv68/3ul0chw3Pz+vbdEvqkVaA1iW/e2337QtZHYYg2QyKctydntCd3d3JpP54Ycf9BsNM5tDQeRv2L//WKX+/t923+twODiOu3fvnrYlnU7Lsnz69OlSF/MfhjbqEydOkISqKRhjUFAqlfr7j9W//1h9/vx5pcsCloCQKF7JprlwOp3BYHB9ff3hw4fPnz93uVwk45J/33jjDcPxDMN8//332svm5mbDAfrhVz6f79y5c2Sgv/6YJ0+ekHoz++Qsy/7888+Gjbu+yuricrlu3rxZc+h1quY/O3h7T0+Pvkl/amqK47iCHSo7Zmijfu211wwH5I8xKIbL5ao59HrNodeLGbEB1QAhUbzSzyrV2tqaSCR4nh8dHaUo6s8//6QoqqmpyfCssf7WtqBgMBgMBmVZbmpqyh4Fs6US1qQ19v+WtqnBmlwul3bJJNEuLi5+8sknO8u15InJTCYTj8fJy1gs1tPTs60zNDQ0WLNvtZpDouaVV3ccEvsYQqLMH3hJKgcyerlsU2qbNYljc3MzGSlz+PDhXI3jiUSi+BOSeUDIKJhr164NDw/nP35lZWXXF1GN9Il2l3+uMgwjiuLc3JzW7L/d9vy33noLa4NXXAlDAvYHK4RESSqHx48fl3NK7d2mW1VV6+rqtnyggqZp0tJL03QJn4/0er1kolSKot577z0y8jm7VLIsv/nmm6X6T6uBGV+hjo4O0p587949Q9dpMU6ePJlrgipVVd1uN57kMZUValWwFOuExO4rh3Q6XeYptXebbkmHKGk31pucnGxpaSE/e73e7PHigiAUOQkfmRLTsNFut5NGAJZlb9y4YdhLHjjRr9UFBd29e7fkXyFyOxuPx6PRaFdX13bfzjDM4ODgtWvXsr85IyMjsixnd9BCCZkRErCnWSckdlk5kCdIyzyl9oHdnyISiTQ1NVEUdf78+dra2o2NjVu3bq2vr1++fJkccPHiRY7j/H7/xYsXHQ6HoihDQ0Oqqh49erSY87/zzjtnzpyZmJjo7OxkGCaZTE5OTvb29pK9MzMzHo/nyJEjnZ2d5OTT09MDAwNkhDdUFsMwXq/3iy++yGQyOxsZ3t/fv7q66nK5hoaGTp06RbpbIpHI8vLy4uIihr/taTabLRAI4Dl4yENVVcON2cGDB8mIy+Irh19++UX7eWNjY25uLhQK8Txf5im1S5Bujx8/nkqlRkdH29raSBtyS0vL4uKiNgbV4XBIknTjxg2O4zKZDMuyLS0tt2/fLrKudDgcS0tLV65c+fjjjymKYlm2t7dX+4o6nU79ycn/nkqlzBsBC9vS3t4eCoV8Pt+OU2MwGDxx4kQkErl69SoJgJaWlmAwuN2maQDYcyRJIrdzGp7ntXE/RVYOJHcQJEfcv3+//NN82sgkEpqX6jmKov56JpW5HJaFDwSfgEGVfyAlvPx9c3eLkKjmy8+W6wPB8vIAAACmQ7oFACuKx+PaehJut1t7gHtsbGzLp+r9fr82plJVVXKYtuS4/okRsuS4qqpk4ZOCC5gDlATSLQBYTjKZbGtr+/LLL8m6I263u62tjQyZ6ezslGU5+7kG/eh3QRAePHgwMzNDFjVZX18XBMHwjObIyIjH49nuBAAAO4Z0CwCW8+TJE5/PR57lYxgmGAyyLPvo0SMydpLnef103CTXag+eRaNRWZYTiQQZL+lwOG7fvp3JZKanpw3/S19fX3kvC6oa0i0AWE5/f38wGNRvqaur+/HHH8nPXV1dhhU2Z2dnvV4vGf0eiURaWlr0I+HJBGfffvut/i3t7e0mXwTAC5BuAWCP0e5iyUtFUWKxmHarury8fOzYMcNbXn75ZcM87bW1teUqLwCFdAsAFjUxMSEIwpaLmpDpU2ZnZ8nLhYUFlmW1R+0zmczAwIBhTZSBgYEKXQfAP5BuAcBy3G739evXu7q6ZFkmK5rwPK8/4OzZs7FYjIx+CofDly5d0naxLBsIBLZc0KYSlwLwjxLMKgUAUELJZFKSpPxzw5H50qenpxsbGyVJIuuPERzHra6ulquwAMXC3S0AWJF+inlVVZeXlw0HiKIYDoenpqZEUdRP2kfWoTI89jM8PDwxMWF+qQFyQroFgIpZXV1NvkhRlKNHj9I0PTIyQlJmMpn86KOPsme47e7uJve1HR0d+u1er5dlWUEQyFoxZMqLUCjU2NhY3osDeAHSLQBUTCgUanrR9PQ0wzCLi4vr6+uHDh2y2WxXrlwJBAJHjhwxvNfhcHAct76+np2JE4nEhx9++MEHH9hstvr6+p9++km/aApARWCJggLwgeATMKjyD8RSly8IQkNDw1dffVXZYljqMym/Kr/8bFiiAAD2lXg8vry83N3dXemCABQF6RYA9p50On3u3LnR0VEsewx7BR4EAoA9xmaz0TQ9ODiISY9hD0G6BYA9BhNWwF6ExmQAAADTId0CAACYDukWAADAdEi3AAAApkO6BQAAMB3SLQAAgOmQbgEAAEyHdAsAAGA6pFsAAADTbT2rFFnQAECDkAA9xAMYICQKwt0tAACA6Yzr3QIAAEDJ4e4WAADAdEi3AAAApkO6BQAAMB3SLQAAgOn+D4TB/KAus+2iAAAAAElFTkSuQmCC" width="634" height="86" class="img_ev3q"></p>
<p>摄像头采集数据后，送至显示屏设备对应的图层中显示。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2应用程序编译">2.应用程序编译<a href="#2应用程序编译" class="hash-link" aria-label="2.应用程序编译的直接链接" title="2.应用程序编译的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="21-新增程序">2.1 新增程序<a href="#21-新增程序" class="hash-link" aria-label="2.1 新增程序的直接链接" title="2.1 新增程序的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="211-新建工程文件夹">2.1.1 新建工程文件夹<a href="#211-新建工程文件夹" class="hash-link" aria-label="2.1.1 新建工程文件夹的直接链接" title="2.1.1 新建工程文件夹的直接链接">​</a></h4>
<p>在k230_sdk/src/big/mpp/userapps/sample目录下新建工程</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir sample_vivo_100ask</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="212-修改makefile">2.1.2 修改Makefile<a href="#212-修改makefile" class="hash-link" aria-label="2.1.2 修改Makefile的直接链接" title="2.1.2 修改Makefile的直接链接">​</a></h4>
<p>修改k230_sdk/src/big/mpp/userapps/sample目录下的Makefile文件，新增sample_vivo_100ask工程的编译规则</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@cd sample_vivo_100ask; make || exit 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" alt="image-20241024154944074" src="/assets/images/image-20241024154944074-4867f65d164d94283720305242e4e8c3.png" width="1491" height="438" class="img_ev3q"></p>
<p>新增sample_vivo_100ask工程的清理规则：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@cd sample_vivo_100ask; make clean</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" alt="image-20241024155054677" src="/assets/images/image-20241024155054677-20778e282eea206973a5eca52eaa2555.png" width="1372" height="569" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="213-进入工程目录">2.1.3 进入工程目录<a href="#213-进入工程目录" class="hash-link" aria-label="2.1.3 进入工程目录的直接链接" title="2.1.3 进入工程目录的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd sample_vivo_100ask</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="214-新建源码文件">2.1.4 新建源码文件<a href="#214-新建源码文件" class="hash-link" aria-label="2.1.4 新建源码文件的直接链接" title="2.1.4 新建源码文件的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">vi sample_vivo_100ask.c</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>填入源码。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="215-新建makefile文件">2.1.5 新建Makefile文件<a href="#215-新建makefile文件" class="hash-link" aria-label="2.1.5 新建Makefile文件的直接链接" title="2.1.5 新建Makefile文件的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">vi Makefiel</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>填入以下内容：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">include $(MPP_SRC_DIR)/userapps/sample/mpp.mk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">include $(MPP_SRC_DIR)/userapps/sample/rt-smart.mk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CURRECT_DIR_NAME=$(shell basename `pwd`)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LOCAL_SRC_DIR = $(shell pwd)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BIN = $(MPP_SRC_DIR)/userapps/sample/elf/$(CURRECT_DIR_NAME).elf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LIBPATH = $(MPP_LIB_PATH)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LIBS = $(MPP_LIBS)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LOCAL_CFLAGS = -I$(LOCAL_SRC_DIR) \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SRCS = $(wildcard $(LOCAL_SRC_DIR)/*.c)\</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OBJS = $(patsubst %.c,%.o,$(SRCS))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">all: $(BIN)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	@-rm -f $(OBJS)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	@echo &quot;${PWD}/Makefile all&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$(OBJS): %.o : %.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	@echo CC $@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	@$(CC) $(CC_CFLAGS) $(LOCAL_CFLAGS) $(BSP_CFLGAS) $(RTSMART_CFLAGS) $(MPP_USER_CFLGAS) -c $&lt; -o $@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$(BIN): $(OBJS)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	@echo LD $@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	@$(CC) -o $(BIN) $(LINKFLAG) -Wl,--whole-archive -Wl,--no-whole-archive -n --static $(OBJS) -L$(LIBPATH) -Wl,--start-group $(LIBS) -Wl,--end-group</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">clean:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	echo &quot;${PWD}/Makefile clean&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	-rm -rf $(BIN)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	-rm -f $(OBJS)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.PHONY: all clean</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="22-程序编译">2.2 程序编译<a href="#22-程序编译" class="hash-link" aria-label="2.2 程序编译的直接链接" title="2.2 程序编译的直接链接">​</a></h3>
<p>1.进入K230SDK目录</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd ~/k230_sdk</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>2.进入Docker环境</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo docker run -u root -it -v $(pwd):$(pwd) -v $(pwd)/toolchain:/opt/toolchain -w $(pwd) ghcr.io/kendryte/k230_sdk /bin/bash</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>3.配置板级型号</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">make CONF=k230_canmv_dongshanpi_defconfig prepare_memory	</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>4.编译程序</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">make mpp-apps</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>等待编译完成，编译完成后，可执行程序<code>sample_vivo_100ask.elf</code>会生成在<code>k230_sdk/src/big/mpp/userapps/sample/elf</code>目录下。</p>
<p>使用ADB将可执行程序传输至开发板中</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push src/big/mpp/userapps/sample/elf/sample_vivo_100ask.elf /sharefs/app</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="22-程序运行">2.2 程序运行<a href="#22-程序运行" class="hash-link" aria-label="2.2 程序运行的直接链接" title="2.2 程序运行的直接链接">​</a></h3>
<p>使用串口软件访问开发板的大核串口终端。</p>
<blockquote>
<p>如果没有关闭开机自启程序，可按下q+回车键可退出开机自启程序。</p>
</blockquote>
<p>1.进入可执行文件目录</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /sharefs/app</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>2.运行程序</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./sample_vivo_100ask.elf -dev 0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>执行完成后效果如下所示:</p>
<p><img loading="lazy" alt="image-20241024155902343" src="/assets/images/image-20241024155902343-26d00b9527ed64a604ce8fd18c1dc177.png" width="2048" height="685" class="img_ev3q"></p>
<p>此时可以看到显示屏实时显示摄像头捕获数据。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3程序解析">3.程序解析<a href="#3程序解析" class="hash-link" aria-label="3.程序解析的直接链接" title="3.程序解析的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="31-设置摄像头属性">3.1 设置摄像头属性<a href="#31-设置摄像头属性" class="hash-link" aria-label="3.1 设置摄像头属性的直接链接" title="3.1 设置摄像头属性的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">        chn_count = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        cur_dev =  atoi(argv[2]);;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf(&quot;cur_dev(%d), dev_count(%d)\n&quot;, cur_dev, dev_count);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        device_obj[cur_dev].dev_num = cur_dev; //sensor设备号</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        device_obj[cur_dev].dev_enable = K_TRUE; //是否启用设备</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        device_obj[cur_dev].ae_enable = K_TRUE;//default enable ae 自动曝光</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        device_obj[cur_dev].awb_enable = K_TRUE;//default enable awb 自动白平衡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        device_obj[cur_dev].dnr3_enable = K_FALSE;//default disable 3ndr 3D降噪</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        device_obj[cur_dev].hdr_enable = K_FALSE;//default disable hdr 高动态范围</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        device_obj[cur_dev].dw_enable = K_FALSE;//default disable dw 宽动态模式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //parse dev paramters</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf(&quot;cur_chn(%d), chn_count(%d)\n&quot;, cur_chn ,chn_count); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        device_obj[cur_dev].chn_num[cur_chn] = cur_chn; //VI通道的编号</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        device_obj[cur_dev].chn_enable[cur_chn] = K_TRUE; //是否启动通道</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        device_obj[cur_dev].preview[cur_chn] = K_TRUE;//default enable preview 通道的预览功能</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        device_obj[cur_dev].sensor_type =  GC2093_MIPI_CSI2_1920X1080_30FPS_10BIT_LINEAR;//传感器类型</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="32-复位并设置显示设备">3.2 复位并设置显示设备<a href="#32-复位并设置显示设备" class="hash-link" aria-label="3.2 复位并设置显示设备的直接链接" title="3.2 复位并设置显示设备的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    // rst display subsystem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    kd_display_reset();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    connector_type = ST7701_V1_MIPI_2LAN_480X800_30FPS;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    printf(&quot;connector_type = ST7701_V1_MIPI_2LAN_480X800_30FPS;&quot;);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="33-设置摄像头输出格式">3.3 设置摄像头输出格式<a href="#33-设置摄像头输出格式" class="hash-link" aria-label="3.3 设置摄像头输出格式的直接链接" title="3.3 设置摄像头输出格式的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    k_u16 out_width = 800;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    out_width = VICAP_ALIGN_UP(out_width, 16);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    device_obj[cur_dev].out_win[cur_chn ].width = out_width;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    k_u16 out_height = 480;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // out_height = VICAP_ALIGN_UP(out_height, 16);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    device_obj[cur_dev].out_win[cur_chn].height = out_height;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int dev_num = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dev_attr.input_type = VICAP_INPUT_TYPE_SENSOR;//输入类型为sensor数据 </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="34-根据sensor配置获取sensor信息">3.4 根据sensor配置获取sensor信息<a href="#34-根据sensor配置获取sensor信息" class="hash-link" aria-label="3.4 根据sensor配置获取sensor信息的直接链接" title="3.4 根据sensor配置获取sensor信息的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    ret = kd_mpi_vicap_get_sensor_info(device_obj[dev_num].sensor_type, &amp;device_obj[dev_num].sensor_info);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (ret) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf(&quot;sample_vicap, the sensor type not supported!\n&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return ret;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    memcpy(&amp;dev_attr.sensor_info, &amp;device_obj[dev_num].sensor_info, sizeof(k_vicap_sensor_info));</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="35-获取摄像头输入宽高">3.5 获取摄像头输入宽高<a href="#35-获取摄像头输入宽高" class="hash-link" aria-label="3.5 获取摄像头输入宽高的直接链接" title="3.5 获取摄像头输入宽高的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> device_obj[dev_num].in_width = device_obj[dev_num].sensor_info.width; //1920</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    device_obj[dev_num].in_height = device_obj[dev_num].sensor_info.height; //1080</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    printf(&quot;sample_vicap, dev[%d] in size[%dx%d]\n&quot;, \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        dev_num, device_obj[dev_num].in_width, device_obj[dev_num].in_height);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="36-设置vi设备属性">3.6 设置VI设备属性<a href="#36-设置vi设备属性" class="hash-link" aria-label="3.6 设置VI设备属性的直接链接" title="3.6 设置VI设备属性的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    //vicap device attr set 设置VI设备属性</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dev_attr.acq_win.h_start = 0; //采集窗口的水平起始位置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dev_attr.acq_win.v_start = 0; //采集窗口的垂直起始位置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dev_attr.acq_win.width = device_obj[dev_num].in_width; //采集窗口的宽度</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dev_attr.acq_win.height = device_obj[dev_num].in_height; //采集窗口的高度</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dev_attr.mode = VICAP_WORK_ONLINE_MODE; //设备工作模式为在线模式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dev_attr.pipe_ctrl.data = pipe_ctrl; //设置ISP相关控制数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dev_attr.pipe_ctrl.bits.af_enable = 0; //禁用自动对焦</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dev_attr.pipe_ctrl.bits.ae_enable = device_obj[dev_num].ae_enable;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dev_attr.pipe_ctrl.bits.awb_enable = device_obj[dev_num].awb_enable;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dev_attr.pipe_ctrl.bits.dnr3_enable = device_obj[dev_num].dnr3_enable;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dev_attr.pipe_ctrl.bits.ahdr_enable = device_obj[dev_num].hdr_enable;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dev_attr.cpature_frame = 0; //捕获帧数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dev_attr.dw_enable = device_obj[dev_num].dw_enable;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dev_attr.mirror = device_obj[cur_dev].sensor_mirror; //设置镜像模式为设备对象中的传感器镜像模式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ret = kd_mpi_vicap_set_dev_attr(dev_num, dev_attr);//设置VICAP设备属性</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (ret) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf(&quot;sample_vicap, kd_mpi_vicap_set_dev_attr failed.\n&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return ret;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="37设置vi默认输出属性">3.7设置VI默认输出属性<a href="#37设置vi默认输出属性" class="hash-link" aria-label="3.7设置VI默认输出属性的直接链接" title="3.7设置VI默认输出属性的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    int chn_num = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //set default value 设置默认值</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (!device_obj[dev_num].out_format[chn_num]) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        device_obj[dev_num].out_format[chn_num] = PIXEL_FORMAT_YUV_SEMIPLANAR_420; //捕获图像格式为YUV420</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (!device_obj[dev_num].out_win[chn_num].width) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        device_obj[dev_num].out_win[chn_num].width = device_obj[dev_num].in_width; //捕获图像宽度</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (!device_obj[dev_num].out_win[chn_num].height) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        device_obj[dev_num].out_win[chn_num].height = device_obj[dev_num].in_height; //捕获图像高度</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if ( device_obj[dev_num].out_win[chn_num].h_start || device_obj[dev_num].out_win[chn_num].v_start) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        device_obj[dev_num].crop_enable[chn_num] = K_TRUE;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    printf(&quot;sample_vicap, dev_num(%d), chn_num(%d), in_size[%dx%d], out_offset[%d:%d], out_size[%dx%d]\n&quot;, \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        dev_num, chn_num, device_obj[dev_num].in_width, device_obj[dev_num].in_height, \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        device_obj[dev_num].out_win[chn_num].h_start, device_obj[dev_num].out_win[chn_num].v_start, \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        device_obj[dev_num].out_win[chn_num].width, device_obj[dev_num].out_win[chn_num].height);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="38-vo设备初始化">3.8 VO设备初始化<a href="#38-vo设备初始化" class="hash-link" aria-label="3.8 VO设备初始化的直接链接" title="3.8 VO设备初始化的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    ret = sample_vicap_vo_init(connector_type);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (ret) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf(&quot;sample_vicap_vo_init failed\n&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return -1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="381-获取连接器属性">3.8.1 获取连接器属性<a href="#381-获取连接器属性" class="hash-link" aria-label="3.8.1 获取连接器属性的直接链接" title="3.8.1 获取连接器属性的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    ret = kd_mpi_get_connector_info(connector_type, &amp;connector_info);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (ret) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf(&quot;sample_vicap, the sensor type not supported!\n&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return ret;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="382-获取连接器设备节点">3.8.2 获取连接器设备节点<a href="#382-获取连接器设备节点" class="hash-link" aria-label="3.8.2 获取连接器设备节点的直接链接" title="3.8.2 获取连接器设备节点的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    connector_fd = kd_mpi_connector_open(connector_info.connector_name);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (connector_fd &lt; 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf(&quot;%s, connector open failed.\n&quot;, __func__);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return K_ERR_VO_NOTREADY;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="383-打开connector-的电源">3.8.3 打开connector 的电源<a href="#383-打开connector-的电源" class="hash-link" aria-label="3.8.3 打开connector 的电源的直接链接" title="3.8.3 打开connector 的电源的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    kd_mpi_connector_power_set(connector_fd, 1);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="384-初始化连接器设备">3.8.4 初始化连接器设备<a href="#384-初始化连接器设备" class="hash-link" aria-label="3.8.4 初始化连接器设备的直接链接" title="3.8.4 初始化连接器设备的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    kd_mpi_connector_init(connector_fd, connector_info);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="39-配置缓冲区">3.9 配置缓冲区<a href="#39-配置缓冲区" class="hash-link" aria-label="3.9 配置缓冲区的直接链接" title="3.9 配置缓冲区的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> ret = sample_vicap_vb_init(device_obj);//配置缓冲区</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (ret) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf(&quot;sample_vicap_vb_init failed\n&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return -1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="391-设置视频缓冲池属性">3.9.1 设置视频缓冲池属性<a href="#391-设置视频缓冲池属性" class="hash-link" aria-label="3.9.1 设置视频缓冲池属性的直接链接" title="3.9.1 设置视频缓冲池属性的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    config.comm_pool[k].blk_cnt = VICAP_OUTPUT_BUF_NUM; //缓冲区数量</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    config.comm_pool[k].mode = VB_REMAP_MODE_NOCACHE; //无缓存重映射</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    k_u16 out_width = dev_obj[i].out_win[j].width; //输出宽度</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    k_u16 out_height = dev_obj[i].out_win[j].height; //输出高度</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    config.comm_pool[k].blk_size = VICAP_ALIGN_UP((out_width * out_height * 3 / 2) + 4096, VICAP_ALIGN_1K);//计算每个缓冲区的大小，并且进行对齐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dev_obj[i].buf_size[j] = config.comm_pool[k].blk_size;//每个缓冲区大小</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    printf(&quot;%s, dev(%d) chn(%d) pool(%d) buf_size(%d) blk_cnt(%d)\n&quot;, __func__, i, j, k ,dev_obj[i].buf_size[j], config.comm_pool[k].blk_cnt);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ret = kd_mpi_vb_set_config(&amp;config); //设置MPP视频缓存池属性</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="392-设置缓冲池附加信息">3.9.2 设置缓冲池附加信息<a href="#392-设置缓冲池附加信息" class="hash-link" aria-label="3.9.2 设置缓冲池附加信息的直接链接" title="3.9.2 设置缓冲池附加信息的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    memset(&amp;supplement_config, 0, sizeof(supplement_config));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    supplement_config.supplement_config |= VB_SUPPLEMENT_JPEG_MASK;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ret = kd_mpi_vb_set_supplement_config(&amp;supplement_config);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (ret) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf(&quot;vb_set_supplement_config failed ret:%d\n&quot;, ret);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return ret;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="393-初始化视频缓冲池">3.9.3 初始化视频缓冲池<a href="#393-初始化视频缓冲池" class="hash-link" aria-label="3.9.3 初始化视频缓冲池的直接链接" title="3.9.3 初始化视频缓冲池的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    ret = kd_mpi_vb_init();//初始化 MPP 视频缓存池</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (ret) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf(&quot;vb_init failed ret:%d\n&quot;, ret);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return ret;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="310-允许vi通道dump">3.10 允许VI通道dump<a href="#310-允许vi通道dump" class="hash-link" aria-label="3.10 允许VI通道dump的直接链接" title="3.10 允许VI通道dump的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    kd_mpi_vicap_set_dump_reserved(dev_num, chn_num, K_TRUE);//设置是否开启快速dump 模式</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="311-设置vi通道属性">3.11 设置VI通道属性<a href="#311-设置vi通道属性" class="hash-link" aria-label="3.11 设置VI通道属性的直接链接" title="3.11 设置VI通道属性的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    memset(&amp;chn_attr, 0, sizeof(k_vicap_chn_attr));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    chn_attr.out_win.width = device_obj[dev_num].out_win[chn_num].width; //设置输出图像宽度</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    chn_attr.out_win.height = device_obj[dev_num].out_win[chn_num].height; //设置输出图像高度</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (device_obj[dev_num].crop_enable[chn_num]) { //如果设置裁剪参数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        chn_attr.crop_win.width = device_obj[dev_num].crop_win[chn_num].width;  //chn_attr.out_win;1166;// </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        chn_attr.crop_win.height = device_obj[dev_num].crop_win[chn_num].height; //1944;//</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        chn_attr.crop_win.h_start =device_obj[dev_num].out_win[chn_num].h_start;  //713;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        chn_attr.crop_win.v_start =device_obj[dev_num].out_win[chn_num].v_start;  //0;//</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        chn_attr.crop_win.width = device_obj[dev_num].in_width;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        chn_attr.crop_win.height = device_obj[dev_num].in_height;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    chn_attr.scale_win = chn_attr.out_win;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    chn_attr.crop_enable = device_obj[dev_num].crop_enable[chn_num];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    chn_attr.scale_enable = K_FALSE; //缩放关闭</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    chn_attr.chn_enable = K_TRUE; //通道使能</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    chn_attr.pix_format = device_obj[dev_num].out_format[chn_num];//图像格式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    chn_attr.buffer_num = VICAP_OUTPUT_BUF_NUM;//缓冲区数量</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    chn_attr.buffer_size = device_obj[dev_num].buf_size[chn_num];//缓 冲区大小</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    printf(&quot;sample_vicap, set dev(%d) chn(%d) attr, buffer_size(%d), out size[%dx%d]\n&quot;, \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        dev_num, chn_num, chn_attr.buffer_size, chn_attr.out_win.width, chn_attr.out_win.height);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    printf(&quot;sample_vicap out_win h_start is %d ,v_start is %d \n&quot;, chn_attr.out_win.h_start, chn_attr.out_win.v_start);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ret = kd_mpi_vicap_set_chn_attr(dev_num, chn_num, chn_attr);//设置VICAP设备通道属性</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="312-获取连接器信息">3.12 获取连接器信息<a href="#312-获取连接器信息" class="hash-link" aria-label="3.12 获取连接器信息的直接链接" title="3.12 获取连接器信息的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    ret = kd_mpi_get_connector_info(connector_type, &amp;connector_info);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (ret) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf(&quot;sample_vicap, the sensor type not supported!\n&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return ret;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    display_width = connector_info.resolution.hdisplay;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    display_height = connector_info.resolution.vdisplay;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    display_width = VICAP_ALIGN_UP(display_width, 16);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="313-绑定vi和vo通道">3.13 绑定VI和VO通道<a href="#313-绑定vi和vo通道" class="hash-link" aria-label="3.13 绑定VI和VO通道的直接链接" title="3.13 绑定VI和VO通道的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    k_s32 vo_chn = K_VO_DISPLAY_CHN_ID1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    k_vo_layer layer = K_VO_LAYER1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    k_u16 rotation = device_obj[dev_num].rotation[chn_num];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    printf(&quot;sample_vicap, vo_count(%d), dev(%d) chn(%d) bind vo chn(%d) layer(%d) rotation(%d)\n&quot;, vo_count, dev_num, chn_num, vo_chn, layer, rotation);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sample_vicap_bind_vo(dev_num, chn_num, vo_chn);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="314-设置图层信息">3.14 设置图层信息<a href="#314-设置图层信息" class="hash-link" aria-label="3.14 设置图层信息的直接链接" title="3.14 设置图层信息的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    layer_conf.enable[vo_count] = K_TRUE;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layer_conf.width[vo_count] = chn_attr.out_win.width;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layer_conf.height[vo_count] = chn_attr.out_win.height;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layer_conf.rotation[vo_count] = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layer_conf.layer[vo_count] = layer;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="315-图层初始化">3.15 图层初始化<a href="#315-图层初始化" class="hash-link" aria-label="3.15 图层初始化的直接链接" title="3.15 图层初始化的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    ret = sample_vicap_vo_layer_init(&amp;layer_conf, display_width, display_height);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (ret) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf(&quot;sample_vicap, vo layer init failed.\n&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        goto app_exit;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3151-设置旋转属性">3.15.1 设置旋转属性<a href="#3151-设置旋转属性" class="hash-link" aria-label="3.15.1 设置旋转属性的直接链接" title="3.15.1 设置旋转属性的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    for (int i = 0; i &lt; MAX_VO_LAYER_NUM; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (layer_conf-&gt;enable[i]) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            rotation = layer_conf-&gt;rotation[i];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            switch (rotation) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            case 0:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                info[i].act_size.width = layer_conf-&gt;width[i];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                info[i].act_size.height = layer_conf-&gt;height[i];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                info[i].func = K_ROTATION_0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                break;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            case 1:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                info[i].act_size.width = layer_conf-&gt;height[i];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                info[i].act_size.height = layer_conf-&gt;width[i];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                info[i].func = K_ROTATION_90;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                break;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            case 2:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                info[i].act_size.width = layer_conf-&gt;width[i];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                info[i].act_size.height = layer_conf-&gt;height[i];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                info[i].func = K_ROTATION_180;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                break;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            case 3:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                info[i].act_size.width = layer_conf-&gt;height[i];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                info[i].act_size.height = layer_conf-&gt;width[i];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                info[i].func = K_ROTATION_270;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                break;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            case 4:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                info[i].act_size.width = layer_conf-&gt;width[i];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                info[i].act_size.height = layer_conf-&gt;height[i];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                info[i].func = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                break;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            default:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                printf(&quot;invalid roation paramters.\n&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                return -1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            total_height += info[i].act_size.height;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            margin = ((display_height - total_height) / (i+2));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	    if ((total_height &gt; display_height) || (info[i].act_size.width &gt; display_width)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                printf(&quot;%s, the preview window size[%dx%d] exceeds the display window size[%dx%d].\n&quot;, \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    __func__, info[i].act_size.width, total_height, display_width, display_height);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                return -1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            printf(&quot;%s, width(%d), height(%d), margin(%d), total_height(%d)\n&quot;, \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                __func__, info[i].act_size.width, info[i].act_size.height, margin, total_height);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3152-设置图层属性">3.15.2 设置图层属性<a href="#3152-设置图层属性" class="hash-link" aria-label="3.15.2 设置图层属性的直接链接" title="3.15.2 设置图层属性的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    for (int i = 0; i &lt; MAX_VO_LAYER_NUM - 1; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (layer_conf-&gt;enable[i]) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            info[i].offset.x = (display_width - info[i].act_size.width)/2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            info[i].offset.y = margin + relative_height;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            printf(&quot;%s, layer(%d), offset.x(%d), offset.y(%d), relative_height(%d)\n&quot;, __func__, layer_conf-&gt;layer[i], info[i].offset.x, info[i].offset.y, relative_height);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            relative_height += info[i].act_size.height + margin;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            info[i].format = PIXEL_FORMAT_YVU_PLANAR_420;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            info[i].global_alptha = 0xff;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            vo_creat_layer_test(layer_conf-&gt;layer[i], &amp;info[i]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>1.检查图层序号</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    if ((chn_id &gt;= K_MAX_VO_LAYER_NUM) || ((info-&gt;func &amp; K_VO_SCALER_ENABLE) &amp;&amp; (chn_id != K_VO_LAYER0))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            || ((info-&gt;func != 0) &amp;&amp; (chn_id == K_VO_LAYER2)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf(&quot;input layer num failed \n&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return -1 ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>2.设置属性信息</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// set offset</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    attr.display_rect = info-&gt;offset;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // set act</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    attr.img_size = info-&gt;act_size;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // sget size</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    info-&gt;size = info-&gt;act_size.height * info-&gt;act_size.width * 3 / 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //set pixel format</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    attr.pixel_format = info-&gt;format;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (info-&gt;format != PIXEL_FORMAT_YVU_PLANAR_420)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf(&quot;input pix format failed \n&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return -1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // set stride</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    attr.stride = (info-&gt;act_size.width / 8 - 1) + ((info-&gt;act_size.height - 1) &lt;&lt; 16);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // set function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    attr.func = info-&gt;func;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // set scaler attr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    attr.scaler_attr = info-&gt;attr;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>3.设置属性至对应图层</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    kd_mpi_vo_set_video_layer_attr(chn_id, &amp;attr);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>4.使能对应图层</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    kd_mpi_vo_enable_video_layer(chn_id);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="316-vi设备初始化">3.16 VI设备初始化<a href="#316-vi设备初始化" class="hash-link" aria-label="3.16 VI设备初始化的直接链接" title="3.16 VI设备初始化的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ret = kd_mpi_vicap_init(dev_num);//VICAP设备初始化</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (ret) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf(&quot;sample_vicap, vicap dev(%d) init failed.\n&quot;, dev_num);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        goto app_exit;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="317-启动vi设备">3.17 启动VI设备<a href="#317-启动vi设备" class="hash-link" aria-label="3.17 启动VI设备的直接链接" title="3.17 启动VI设备的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    ret = kd_mpi_vicap_start_stream(dev_num);//启动VICAP设备输出数据流</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (ret) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf(&quot;sample_vicap, vicap dev(%d) start stream failed.\n&quot;, dev_num);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        goto app_exit;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/100askTeam/eLinuxAI-TrainingDocs/tree/main/docs/CanaanK230/part2/part1/06_AchieveRealTimePreviewCameraDisplay.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/CanaanK230/part2/part1/DisplayExperimentDifferentResolutions"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">显示屏实验-显示不同分辨率图像</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/CanaanK230/part2/part1/CameraExperimentEncodingVideoStream"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">摄像头实验-编码视频流</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1数据流框图" class="table-of-contents__link toc-highlight">1.数据流框图</a></li><li><a href="#2应用程序编译" class="table-of-contents__link toc-highlight">2.应用程序编译</a><ul><li><a href="#21-新增程序" class="table-of-contents__link toc-highlight">2.1 新增程序</a></li><li><a href="#22-程序编译" class="table-of-contents__link toc-highlight">2.2 程序编译</a></li><li><a href="#22-程序运行" class="table-of-contents__link toc-highlight">2.2 程序运行</a></li></ul></li><li><a href="#3程序解析" class="table-of-contents__link toc-highlight">3.程序解析</a><ul><li><a href="#31-设置摄像头属性" class="table-of-contents__link toc-highlight">3.1 设置摄像头属性</a></li><li><a href="#32-复位并设置显示设备" class="table-of-contents__link toc-highlight">3.2 复位并设置显示设备</a></li><li><a href="#33-设置摄像头输出格式" class="table-of-contents__link toc-highlight">3.3 设置摄像头输出格式</a></li><li><a href="#34-根据sensor配置获取sensor信息" class="table-of-contents__link toc-highlight">3.4 根据sensor配置获取sensor信息</a></li><li><a href="#35-获取摄像头输入宽高" class="table-of-contents__link toc-highlight">3.5 获取摄像头输入宽高</a></li><li><a href="#36-设置vi设备属性" class="table-of-contents__link toc-highlight">3.6 设置VI设备属性</a></li><li><a href="#37设置vi默认输出属性" class="table-of-contents__link toc-highlight">3.7设置VI默认输出属性</a></li><li><a href="#38-vo设备初始化" class="table-of-contents__link toc-highlight">3.8 VO设备初始化</a></li><li><a href="#39-配置缓冲区" class="table-of-contents__link toc-highlight">3.9 配置缓冲区</a></li><li><a href="#310-允许vi通道dump" class="table-of-contents__link toc-highlight">3.10 允许VI通道dump</a></li><li><a href="#311-设置vi通道属性" class="table-of-contents__link toc-highlight">3.11 设置VI通道属性</a></li><li><a href="#312-获取连接器信息" class="table-of-contents__link toc-highlight">3.12 获取连接器信息</a></li><li><a href="#313-绑定vi和vo通道" class="table-of-contents__link toc-highlight">3.13 绑定VI和VO通道</a></li><li><a href="#314-设置图层信息" class="table-of-contents__link toc-highlight">3.14 设置图层信息</a></li><li><a href="#315-图层初始化" class="table-of-contents__link toc-highlight">3.15 图层初始化</a></li><li><a href="#316-vi设备初始化" class="table-of-contents__link toc-highlight">3.16 VI设备初始化</a></li><li><a href="#317-启动vi设备" class="table-of-contents__link toc-highlight">3.17 启动VI设备</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://dongshanpi.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">DongshanPI<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://canaan-docs.100ask.net/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Canaan-Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://renesas-docs.100ask.net/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Renesas-Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://rtos.100ask.net/" target="_blank" rel="noopener noreferrer" class="footer__link-item">RTOS<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://tina.100ask.net/" target="_blank" rel="noopener noreferrer" class="footer__link-item">TinaSDK-Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://allwinner-docs.100ask.net/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Allwinner-Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://aw-r128.100ask.net/" target="_blank" rel="noopener noreferrer" class="footer__link-item">R128-Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://space.bilibili.com/275908810" target="_blank" rel="noopener noreferrer" class="footer__link-item">BiliBili<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://forums.100ask.net" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://video.100ask.net/" target="_blank" rel="noopener noreferrer" class="footer__link-item">VideoCenter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/dongshanpi" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://weidongshan.coding.net/public/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Coding<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/100askTeam" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://gitee.com/weidongshan" target="_blank" rel="noopener noreferrer" class="footer__link-item">Gitee<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 100askTeam, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>